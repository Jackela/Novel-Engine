{
  "architecture_analysis": {
    "component_structure": {
      "core_components": [
        {
          "name": "character_factory.py",
          "type": "core",
          "size": 6771,
          "classes": 3,
          "functions": 4,
          "imports": 5
        },
        {
          "name": "chronicler_agent.py",
          "type": "core",
          "size": 58224,
          "classes": 3,
          "functions": 34,
          "imports": 11
        },
        {
          "name": "demo_ai_enhanced_chronicler.py",
          "type": "core",
          "size": 17313,
          "classes": 0,
          "functions": 3,
          "imports": 6
        },
        {
          "name": "demo_chronicler_integration.py",
          "type": "core",
          "size": 8864,
          "classes": 1,
          "functions": 5,
          "imports": 6
        },
        {
          "name": "demo_chronicler_transcription.py",
          "type": "core",
          "size": 13081,
          "classes": 0,
          "functions": 4,
          "imports": 6
        },
        {
          "name": "director_agent.py",
          "type": "core",
          "size": 163001,
          "classes": 1,
          "functions": 81,
          "imports": 11
        },
        {
          "name": "persona_agent.py",
          "type": "core",
          "size": 138541,
          "classes": 5,
          "functions": 81,
          "imports": 17
        }
      ],
      "utility_components": [
        {
          "name": "ai_enhancement_analysis.py",
          "type": "utility",
          "size": 13721,
          "classes": 0,
          "functions": 6
        },
        {
          "name": "api_server.py",
          "type": "utility",
          "size": 92097,
          "classes": 12,
          "functions": 29
        },
        {
          "name": "campaign_brief.py",
          "type": "utility",
          "size": 14627,
          "classes": 3,
          "functions": 9
        },
        {
          "name": "config_loader.py",
          "type": "utility",
          "size": 29815,
          "classes": 23,
          "functions": 33
        },
        {
          "name": "demonstration_summary.py",
          "type": "utility",
          "size": 7872,
          "classes": 0,
          "functions": 2
        },
        {
          "name": "demo_config_usage.py",
          "type": "utility",
          "size": 6358,
          "classes": 0,
          "functions": 6
        },
        {
          "name": "demo_llm_integration.py",
          "type": "utility",
          "size": 8721,
          "classes": 0,
          "functions": 4
        },
        {
          "name": "evaluate_baseline.py",
          "type": "utility",
          "size": 35270,
          "classes": 6,
          "functions": 19
        },
        {
          "name": "example_usage.py",
          "type": "utility",
          "size": 14027,
          "classes": 0,
          "functions": 1
        },
        {
          "name": "final_validation.py",
          "type": "utility",
          "size": 9953,
          "classes": 0,
          "functions": 1
        },
        {
          "name": "narrative_actions.py",
          "type": "utility",
          "size": 17673,
          "classes": 4,
          "functions": 11
        },
        {
          "name": "run_complete_demo.py",
          "type": "utility",
          "size": 31991,
          "classes": 1,
          "functions": 13
        },
        {
          "name": "run_simulation.py",
          "type": "utility",
          "size": 13124,
          "classes": 0,
          "functions": 6
        },
        {
          "name": "shared_types.py",
          "type": "utility",
          "size": 1786,
          "classes": 2,
          "functions": 1
        },
        {
          "name": "simple_demo.py",
          "type": "utility",
          "size": 3101,
          "classes": 0,
          "functions": 0
        }
      ],
      "test_components": [
        {
          "name": "fix_test_file.py",
          "type": "test",
          "size": 2059,
          "classes": 1,
          "functions": 1
        },
        {
          "name": "fix_test_file_comprehensive.py",
          "type": "test",
          "size": 14181,
          "classes": 9,
          "functions": 20
        },
        {
          "name": "test_api_server.py",
          "type": "test",
          "size": 140199,
          "classes": 20,
          "functions": 105
        },
        {
          "name": "test_api_startup.py",
          "type": "test",
          "size": 3796,
          "classes": 0,
          "functions": 1
        },
        {
          "name": "test_chronicler_agent.py",
          "type": "test",
          "size": 43658,
          "classes": 7,
          "functions": 33
        },
        {
          "name": "test_config_integration.py",
          "type": "test",
          "size": 5882,
          "classes": 0,
          "functions": 6
        },
        {
          "name": "test_director_agent.py",
          "type": "test",
          "size": 36908,
          "classes": 15,
          "functions": 46
        },
        {
          "name": "test_fix_p02.py",
          "type": "test",
          "size": 4284,
          "classes": 0,
          "functions": 1
        },
        {
          "name": "test_integration.py",
          "type": "test",
          "size": 22928,
          "classes": 5,
          "functions": 16
        },
        {
          "name": "test_llm_specific_functionality.py",
          "type": "test",
          "size": 13225,
          "classes": 1,
          "functions": 12
        },
        {
          "name": "test_memory_functionality.py",
          "type": "test",
          "size": 2491,
          "classes": 0,
          "functions": 1
        },
        {
          "name": "test_narrative_engine.py",
          "type": "test",
          "size": 23742,
          "classes": 6,
          "functions": 26
        },
        {
          "name": "test_p03_comprehensive.py",
          "type": "test",
          "size": 7677,
          "classes": 0,
          "functions": 1
        },
        {
          "name": "test_persona_agent.py",
          "type": "test",
          "size": 22274,
          "classes": 10,
          "functions": 24
        },
        {
          "name": "test_world_heart_system.py",
          "type": "test",
          "size": 23872,
          "classes": 5,
          "functions": 20
        },
        {
          "name": "uat_test_script.py",
          "type": "test",
          "size": 14749,
          "classes": 2,
          "functions": 11
        }
      ],
      "total_files": 38,
      "component_health": "good"
    },
    "data_flow_analysis": {
      "input_sources": [
        "director_agent.py",
        "chronicler_agent.py",
        "character_factory.py"
      ],
      "data_transformations": [
        "director_agent.py",
        "chronicler_agent.py",
        "character_factory.py"
      ],
      "output_destinations": [
        "director_agent.py",
        "chronicler_agent.py"
      ],
      "complexity_score": 100
    },
    "api_design_analysis": {
      "endpoints": [
        {
          "method": "get",
          "path": "/"
        },
        {
          "method": "get",
          "path": "/health"
        },
        {
          "method": "get",
          "path": "/meta/system-status"
        },
        {
          "method": "get",
          "path": "/meta/policy"
        },
        {
          "method": "get",
          "path": "/characters"
        },
        {
          "method": "get",
          "path": "/characters/{character_name}"
        },
        {
          "method": "get",
          "path": "/characters/{character_name}/enhanced"
        },
        {
          "method": "post",
          "path": "/characters"
        },
        {
          "method": "post",
          "path": "/simulations"
        },
        {
          "method": "get",
          "path": "/campaigns"
        },
        {
          "method": "post",
          "path": "/campaigns"
        }
      ],
      "design_patterns": [
        "FastAPI",
        "Async/Await",
        "HTTP Exception Handling"
      ],
      "error_handling": "structured",
      "documentation_coverage": 158.6206896551724
    },
    "integration_points": {
      "file_system_integration": [
        "ai_enhancement_analysis.py",
        "api_server.py",
        "campaign_brief.py",
        "character_factory.py",
        "chronicler_agent.py",
        "config_loader.py",
        "demonstration_summary.py",
        "demo_ai_enhanced_chronicler.py",
        "demo_chronicler_integration.py",
        "demo_chronicler_transcription.py",
        "director_agent.py",
        "evaluate_baseline.py",
        "example_usage.py",
        "final_validation.py",
        "fix_test_file.py",
        "fix_test_file_comprehensive.py",
        "persona_agent.py",
        "run_complete_demo.py",
        "run_simulation.py",
        "simple_demo.py",
        "test_api_server.py",
        "test_api_startup.py",
        "test_chronicler_agent.py",
        "test_config_integration.py",
        "test_director_agent.py",
        "test_fix_p02.py",
        "test_integration.py",
        "test_memory_functionality.py",
        "test_narrative_engine.py",
        "test_p03_comprehensive.py",
        "test_persona_agent.py",
        "test_world_heart_system.py",
        "uat_test_script.py"
      ],
      "configuration_integration": [
        "api_server.py",
        "campaign_brief.py",
        "character_factory.py",
        "chronicler_agent.py",
        "config_loader.py",
        "demo_ai_enhanced_chronicler.py",
        "demo_config_usage.py",
        "director_agent.py",
        "evaluate_baseline.py",
        "example_usage.py",
        "fix_test_file_comprehensive.py",
        "persona_agent.py",
        "run_complete_demo.py",
        "run_simulation.py",
        "test_api_server.py",
        "test_api_startup.py",
        "test_chronicler_agent.py",
        "test_config_integration.py",
        "test_director_agent.py",
        "test_integration.py",
        "test_narrative_engine.py",
        "test_p03_comprehensive.py",
        "test_persona_agent.py",
        "test_world_heart_system.py",
        "uat_test_script.py"
      ],
      "external_libraries": [
        "asyncio",
        "requests",
        "yaml",
        "random",
        "uvicorn",
        "narrative_actions",
        "enum",
        "fastapi",
        "pydantic",
        "director_agent",
        "starlette",
        "unittest",
        "pytest",
        "argparse",
        "logging",
        "api_server",
        "character_factory",
        "campaign_brief",
        "uuid",
        "tempfile",
        "chronicler_agent",
        "functools",
        "config_loader",
        "persona_agent",
        "shared_types",
        "src",
        "dataclasses",
        "threading",
        "statistics",
        "shutil",
        "contextlib",
        "time",
        "character",
        "urllib3"
      ],
      "integration_complexity": "high"
    },
    "architectural_patterns": [
      "Factory Pattern",
      "Agent Pattern"
    ]
  },
  "code_quality_metrics": {
    "complexity_analysis": {
      "files_analyzed": 38,
      "total_complexity": 3361,
      "average_complexity": 88.44736842105263,
      "high_complexity_files": [
        {
          "file": "api_server.py",
          "complexity": 283
        },
        {
          "file": "campaign_brief.py",
          "complexity": 54
        },
        {
          "file": "chronicler_agent.py",
          "complexity": 239
        },
        {
          "file": "config_loader.py",
          "complexity": 161
        },
        {
          "file": "director_agent.py",
          "complexity": 527
        },
        {
          "file": "evaluate_baseline.py",
          "complexity": 125
        },
        {
          "file": "fix_test_file_comprehensive.py",
          "complexity": 63
        },
        {
          "file": "persona_agent.py",
          "complexity": 476
        },
        {
          "file": "test_api_server.py",
          "complexity": 357
        },
        {
          "file": "test_chronicler_agent.py",
          "complexity": 101
        },
        {
          "file": "test_director_agent.py",
          "complexity": 126
        },
        {
          "file": "test_integration.py",
          "complexity": 63
        },
        {
          "file": "test_narrative_engine.py",
          "complexity": 72
        },
        {
          "file": "test_persona_agent.py",
          "complexity": 81
        },
        {
          "file": "test_world_heart_system.py",
          "complexity": 60
        }
      ],
      "score": 30
    },
    "style_compliance": {
      "naming_convention_score": 55.26315789473685,
      "formatting_score": 100.0,
      "import_organization_score": 97.36842105263158,
      "score": 84.21052631578948,
      "style_issues": []
    },
    "documentation_quality": {
      "files_with_docstrings": 0,
      "functions_with_docstrings": 365,
      "total_functions": 386,
      "classes_with_docstrings": 0,
      "total_classes": 145,
      "coverage_percentage": 68.7382297551789,
      "score": 68.7382297551789
    },
    "error_handling_coverage": {
      "files_with_error_handling": 33,
      "total_try_blocks": 207,
      "specific_exceptions": 28,
      "generic_exceptions": 1,
      "error_handling_score": 100,
      "score": 100
    },
    "test_coverage_estimate": {
      "test_files_found": 16,
      "test_functions": 239,
      "source_files": 22,
      "estimated_coverage": 100,
      "score": 100
    },
    "overall_quality_score": 76.58975121419368,
    "quality_grade": "C"
  },
  "dependency_analysis": {
    "external_dependencies": [
      "asyncio",
      "requests",
      "yaml",
      "random",
      "uvicorn",
      "enum",
      "fastapi",
      "pydantic",
      "starlette",
      "unittest",
      "pytest",
      "argparse",
      "uuid",
      "functools",
      "src",
      "dataclasses",
      "threading",
      "statistics",
      "shutil",
      "contextlib",
      "character",
      "urllib3"
    ],
    "internal_dependencies": {
      "ai_enhancement_analysis": [],
      "api_server": [
        "config_loader",
        "character_factory",
        "director_agent",
        "chronicler_agent",
        "persona_agent"
      ],
      "campaign_brief": [],
      "character_factory": [
        "persona_agent"
      ],
      "chronicler_agent": [
        "config_loader"
      ],
      "config_loader": [],
      "demonstration_summary": [],
      "demo_ai_enhanced_chronicler": [
        "chronicler_agent"
      ],
      "demo_chronicler_integration": [
        "chronicler_agent",
        "director_agent",
        "persona_agent"
      ],
      "demo_chronicler_transcription": [
        "chronicler_agent"
      ],
      "demo_config_usage": [
        "config_loader"
      ],
      "demo_llm_integration": [
        "persona_agent",
        "character_factory"
      ],
      "director_agent": [
        "persona_agent",
        "shared_types",
        "config_loader",
        "campaign_brief",
        "narrative_actions"
      ],
      "evaluate_baseline": [],
      "example_usage": [],
      "final_validation": [],
      "fix_test_file": [],
      "fix_test_file_comprehensive": [
        "persona_agent"
      ],
      "narrative_actions": [
        "shared_types"
      ],
      "persona_agent": [
        "shared_types",
        "narrative_actions"
      ],
      "run_complete_demo": [],
      "run_simulation": [
        "director_agent",
        "persona_agent",
        "character_factory",
        "config_loader"
      ],
      "shared_types": [],
      "simple_demo": [],
      "test_api_server": [
        "api_server"
      ],
      "test_api_startup": [],
      "test_chronicler_agent": [
        "chronicler_agent"
      ],
      "test_config_integration": [
        "config_loader",
        "director_agent",
        "chronicler_agent"
      ],
      "test_director_agent": [
        "persona_agent",
        "director_agent"
      ],
      "test_fix_p02": [
        "chronicler_agent"
      ],
      "test_integration": [
        "director_agent",
        "persona_agent",
        "character_factory"
      ],
      "test_llm_specific_functionality": [
        "persona_agent",
        "character_factory"
      ],
      "test_memory_functionality": [
        "persona_agent",
        "character_factory"
      ],
      "test_narrative_engine": [
        "director_agent",
        "persona_agent",
        "campaign_brief",
        "narrative_actions"
      ],
      "test_p03_comprehensive": [
        "character_factory",
        "director_agent",
        "chronicler_agent"
      ],
      "test_persona_agent": [
        "persona_agent"
      ],
      "test_world_heart_system": [
        "director_agent",
        "persona_agent",
        "shared_types"
      ],
      "uat_test_script": []
    },
    "circular_dependencies": [],
    "dependency_health": "concerning"
  },
  "security_assessment": {
    "potential_vulnerabilities": [],
    "input_validation": {
      "validation_functions": 34,
      "sanitization_patterns": 23,
      "score": 100
    },
    "file_operations": {
      "safe_file_operations": 80,
      "potentially_unsafe_operations": 0,
      "score": 100.0
    },
    "security_score": 200.0
  },
  "performance_indicators": {
    "async_usage": {
      "async_functions": 30,
      "await_usage": 32,
      "async_score": 0,
      "score": 100
    },
    "caching_patterns": {
      "caching_implementations": 6,
      "cache_libraries": [
        "functools.lru_cache"
      ],
      "score": 100
    },
    "resource_management": {
      "context_managers": 633,
      "proper_cleanup": 13,
      "score": 100
    },
    "performance_score": 100.0
  },
  "maintainability_score": {
    "technical_debt_indicators": [
      {
        "file": "api_server.py",
        "type": "Empty Implementation",
        "location": "Line 845",
        "snippet": "pass  #"
      },
      {
        "file": "chronicler_agent.py",
        "type": "Code Marked for Removal",
        "location": "Line 1094",
        "snippet": "# Remove"
      },
      {
        "file": "director_agent.py",
        "type": "Code Marked for Removal",
        "location": "Line 2128",
        "snippet": "# Remove"
      },
      {
        "file": "director_agent.py",
        "type": "Code Marked for Removal",
        "location": "Line 2133",
        "snippet": "# Remove"
      },
      {
        "file": "director_agent.py",
        "type": "Code Marked for Removal",
        "location": "Line 2332",
        "snippet": "# Remove"
      },
      {
        "file": "final_validation.py",
        "type": "Temporary Code",
        "location": "Line 37",
        "snippet": "# Temp"
      },
      {
        "file": "test_api_server.py",
        "type": "Empty Implementation",
        "location": "Line 410",
        "snippet": "pass\n        \n        #"
      },
      {
        "file": "test_chronicler_agent.py",
        "type": "Empty Implementation",
        "location": "Line 823",
        "snippet": "pass  #"
      },
      {
        "file": "test_persona_agent.py",
        "type": "Code Marked for Removal",
        "location": "Line 501",
        "snippet": "# Remove"
      }
    ],
    "code_duplication": {
      "function_signatures": [
        "main",
        "__init__",
        "example_usage",
        "create_test_character_directory",
        "test_persona_agent_import",
        "test_enum_imports",
        "test_dataclass_imports",
        "test_initialization_with_test_character",
        "test_agent_id_derivation",
        "test_initialization_with_custom_agent_id",
        "test_initialization_properties",
        "test_load_character_context_basic",
        "test_character_name_loading",
        "test_faction_loading",
        "test_personality_traits_loading",
        "test_load_character_context_explicit_call",
        "test_directory_not_found_error",
        "mock_gemini_api",
        "basic_agent",
        "test_decision_loop_basic",
        "test_agent_fixture",
        "test_decision_with_fixture",
        "character_creation_side_effect",
        "mock_exists_func",
        "temp_dir",
        "setup_method",
        "teardown_method"
      ],
      "similar_blocks": 0,
      "estimated_duplication": 6.994818652849741
    },
    "modularity_score": {
      "average_file_size": 28627.78947368421,
      "function_count_distribution": {},
      "class_count_distribution": {},
      "score": -4.504912280701745
    },
    "maintainability_score": 0
  },
  "timestamp": "2025-08-13T23:59:30.903984",
  "executive_summary": {
    "analysis_date": "2025-08-13T23:59:31.339375",
    "overall_architecture_health": "EXCELLENT",
    "critical_issues": [
      "Low maintainability score indicates high technical debt"
    ],
    "recommendations": [
      "Improve documentation coverage - aim for 80%+ docstring coverage",
      "Reduce code complexity - consider refactoring complex functions",
      "Address technical debt - 9 items identified for cleanup"
    ]
  }
}