{
  "namespace": "com.novelengine.knowledge.events",
  "description": "Domain events for Knowledge Management bounded context (Article VI - EDA)",
  "schemas": [
    {
      "type": "record",
      "name": "KnowledgeEntryCreated",
      "doc": "Published when a new knowledge entry is created (FR-002)",
      "fields": [
        {
          "name": "event_id",
          "type": "string",
          "doc": "Unique event identifier (UUID)"
        },
        {
          "name": "entry_id",
          "type": "string",
          "doc": "Knowledge entry ID (UUID)"
        },
        {
          "name": "knowledge_type",
          "type": {
            "type": "enum",
            "name": "KnowledgeType",
            "symbols": ["PROFILE", "OBJECTIVE", "MEMORY", "LORE", "RULES"]
          },
          "doc": "Type of knowledge entry"
        },
        {
          "name": "owning_character_id",
          "type": ["null", "string"],
          "default": null,
          "doc": "Character ID (null for world knowledge)"
        },
        {
          "name": "created_by",
          "type": "string",
          "doc": "User ID who created the entry"
        },
        {
          "name": "timestamp",
          "type": {
            "type": "long",
            "logicalType": "timestamp-millis"
          },
          "doc": "Event timestamp (ISO 8601 milliseconds since epoch)"
        },
        {
          "name": "correlation_id",
          "type": ["null", "string"],
          "default": null,
          "doc": "Request correlation ID for distributed tracing"
        }
      ]
    },
    {
      "type": "record",
      "name": "KnowledgeEntryUpdated",
      "doc": "Published when a knowledge entry is updated (FR-003)",
      "fields": [
        {
          "name": "event_id",
          "type": "string",
          "doc": "Unique event identifier (UUID)"
        },
        {
          "name": "entry_id",
          "type": "string",
          "doc": "Knowledge entry ID (UUID)"
        },
        {
          "name": "updated_by",
          "type": "string",
          "doc": "User ID who updated the entry"
        },
        {
          "name": "timestamp",
          "type": {
            "type": "long",
            "logicalType": "timestamp-millis"
          },
          "doc": "Event timestamp (ISO 8601 milliseconds since epoch)"
        },
        {
          "name": "correlation_id",
          "type": ["null", "string"],
          "default": null,
          "doc": "Request correlation ID for distributed tracing"
        }
      ]
    },
    {
      "type": "record",
      "name": "KnowledgeEntryDeleted",
      "doc": "Published when a knowledge entry is deleted (FR-004)",
      "fields": [
        {
          "name": "event_id",
          "type": "string",
          "doc": "Unique event identifier (UUID)"
        },
        {
          "name": "entry_id",
          "type": "string",
          "doc": "Knowledge entry ID (UUID)"
        },
        {
          "name": "deleted_by",
          "type": "string",
          "doc": "User ID who deleted the entry"
        },
        {
          "name": "timestamp",
          "type": {
            "type": "long",
            "logicalType": "timestamp-millis"
          },
          "doc": "Event timestamp (ISO 8601 milliseconds since epoch)"
        },
        {
          "name": "correlation_id",
          "type": ["null", "string"],
          "default": null,
          "doc": "Request correlation ID for distributed tracing"
        }
      ]
    }
  ],
  "kafka_topics": {
    "knowledge.entry.created": {
      "event": "KnowledgeEntryCreated",
      "partitioning": "entry_id",
      "retention_ms": 604800000,
      "description": "7 days retention for created events"
    },
    "knowledge.entry.updated": {
      "event": "KnowledgeEntryUpdated",
      "partitioning": "entry_id",
      "retention_ms": 604800000,
      "description": "7 days retention for updated events"
    },
    "knowledge.entry.deleted": {
      "event": "KnowledgeEntryDeleted",
      "partitioning": "entry_id",
      "retention_ms": 2592000000,
      "description": "30 days retention for deleted events (compliance)"
    }
  },
  "subscribers": {
    "audit_logging": {
      "subscribes_to": [
        "knowledge.entry.created",
        "knowledge.entry.updated",
        "knowledge.entry.deleted"
      ],
      "description": "Audit log consumer for FR-011 compliance"
    },
    "cache_invalidation": {
      "subscribes_to": [
        "knowledge.entry.updated",
        "knowledge.entry.deleted"
      ],
      "description": "Redis cache invalidation consumer (post-MVP)"
    },
    "notification_service": {
      "subscribes_to": [
        "knowledge.entry.created",
        "knowledge.entry.updated",
        "knowledge.entry.deleted"
      ],
      "description": "Game Master notification system (optional)"
    }
  }
}
