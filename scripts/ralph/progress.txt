# Ralph Progress Log
Started: Sun Feb  1 17:25:24     2026

## Codebase Patterns
- Character aggregate uses Optional fields for mutable state (not on frozen CharacterProfile)
- recharts is already installed in frontend - use Radar/RadarChart for personality visualization
- Frontend types in `frontend/src/types/schemas.ts` must match backend `src/api/schemas.py`
- CharacterDetailsDialog uses Tabs component with TabsList/TabsTrigger/TabsContent pattern
- Character memories stored in structured_data.memories via workspace_character_store
- API routers go in `src/api/routers/` and register in `main_api_server.py`

---

## [CHAR-023] - 2026-02-01
- What was implemented: CharacterMemory value object (frozen dataclass) with content, importance (1-10), tags, timestamp, memory_id. Character aggregate now has memories list, add_memory() method, and helper methods (get_memories, get_core_memories, get_memories_by_tag, get_recent_memories). Created memories.py router with CRUD endpoints. Added CharacterMemorySchema to schemas.py. Created 31 unit tests covering validation, business logic, and aggregate integration.
- Files changed:
  - `src/contexts/character/domain/value_objects/character_memory.py` (new)
  - `src/contexts/character/domain/value_objects/__init__.py`
  - `src/contexts/character/domain/aggregates/character.py`
  - `src/api/routers/memories.py` (new)
  - `src/api/schemas.py`
  - `src/api/main_api_server.py`
  - `tests/unit/contexts/character/domain/test_character_memory.py` (new)
  - `scripts/ralph/prd.json`
- **Learnings for future iterations:**
  - Use frozen dataclass with tuple (not list) for immutable value objects
  - Convert lists to tuples in __post_init__ for frozen dataclasses
  - is_core_memory() threshold is importance > 8 (not >= 9)
  - Memory importance levels: 1-3=minor, 4-6=moderate, 7-8=significant, 9-10=core
  - Memories are stored in character's structured_data.memories for workspace characters
---

## [CHAR-022] - 2026-02-01
- What was implemented: PsychologyChart.tsx component using Recharts RadarChart to visualize Big Five personality traits. Added CharacterPsychologySchema to frontend types. Integrated chart into CharacterDetailsDialog as a new "Psychology" tab. Updated backend CharacterDetailResponse to include optional psychology field.
- Files changed:
  - `frontend/src/features/characters/components/PsychologyChart.tsx` (new)
  - `frontend/src/features/characters/CharacterDetailsDialog.tsx`
  - `frontend/src/types/schemas.ts`
  - `src/api/schemas.py`
  - `scripts/ralph/prd.json`
- **Learnings for future iterations:**
  - recharts already installed, use ResponsiveContainer for proper sizing
  - Custom tooltip requires null check for payload[0] to satisfy TypeScript strict mode
  - Use hsl(var(--css-variable)) pattern for theming recharts components
  - TabsList grid-cols must match number of TabsTrigger children
---

## [CHAR-021] - 2026-02-01
- What I implemented: CharacterPsychology value object using Big Five (OCEAN) model with all required traits (openness, conscientiousness, extraversion, agreeableness, neuroticism). Added optional `psychology` field to Character aggregate with `update_psychology()` method. Created `CharacterPsychologySchema` Pydantic model in schemas.py. Added 18 comprehensive unit tests.
- Pattern discovered: The Character aggregate uses Optional fields for mutable state that isn't part of the frozen CharacterProfile. This follows the convention noted in techContext to "Extend Character aggregate (not frozen CharacterProfile) for mutable state".
- Gotcha for future: CharacterProfile is frozen (immutable dataclass), so new mutable character properties should go on the Character aggregate directly, not on the profile.
