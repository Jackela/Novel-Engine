{
  "project": "Novel-Engine-Narrative",
  "branchName": "feat/domain-and-fortification",
  "description": "Phase 3: The Narrative Engine. Implementing Streaming Generation & Editor using BDD.",
  "userStories": [
    {
      "id": "NAR-001",
      "title": "BDD Spec: The Writer's Flow",
      "description": "Define the behavior of story generation BEFORE implementing it. This test serves as the requirements document.",
      "acceptanceCriteria": [
        "Create `frontend/tests/e2e/story-generation.spec.ts`",
        "Test Scenario 1: User clicks 'New Chapter' -> assert 'Generating...' state appears",
        "Test Scenario 2: Mock SSE stream -> assert text appears incrementally in the editor",
        "Test Scenario 3: Verify 'World Context' is sent in the payload (mock request inspection)",
        "Run test: MUST FAIL (Red state)"
      ],
      "priority": 1,
      "passes": true,
      "notes": "RED state achieved. 5 test scenarios defined, all failing as expected."
    },
    {
      "id": "NAR-002",
      "title": "Backend: Streaming Narrative Service",
      "description": "Implement the SSE (Server-Sent Events) endpoint for story generation.",
      "acceptanceCriteria": [
        "Create `POST /api/narratives/stream` endpoint",
        "Implement `NarrativeGenerator` adapter that yields chunks from LLM",
        "Context Injection: Fetch relevant World Entities + Characters and compress them into the System Prompt",
        "Passes: `NAR-001` test scenario for backend connection"
      ],
      "priority": 2,
      "passes": false,
      "notes": "Performance matters. Latency to first token must be < 2s."
    },
    {
      "id": "NAR-003",
      "title": "Frontend: Immersive Editor (shadcn/ui)",
      "description": "Build the writing interface using our new Design System.",
      "acceptanceCriteria": [
        "Create `NarrativeEditor` component using shadcn `Textarea` or a Tiptap wrapper",
        "Integrate `useStoryStream` hook to handle SSE connection",
        "UI Polish: Use `ScrollArea` from shadcn for long text",
        "Validation: `npm run test:e2e` (NAR-001) MUST PASS (Green state)"
      ],
      "priority": 3,
      "passes": false,
      "notes": "No custom CSS. Use standard components."
    }
  ]
}