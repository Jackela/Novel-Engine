# Golden Master Release - Pull Request

## Summary

**The Great Pruning** - 深度代码库清洁与文档重组，为 Novel Engine 的生产就绪状态奠定坚实基础。

本次发布完成了以下核心目标：
- 移除遗留的 `ai_intelligence` 模块和重复代码
- 重组文档目录结构，遵循标准化命名规范
- 修复所有 CI 测试失败，达到 100% 通过率
- 加强 API 安全头配置（OWASP Top 10 防护）

---

## Breaking Changes

### 移除的模块

| 模块 | 说明 |
|------|------|
| `src/ai_intelligence/` | 完整移除未使用的 AI 智能模块 |
| `contexts/` (根目录) | 迁移至 `src/contexts/` |
| `configs/` | 合并至 `config/` |
| 遗留根级文件 | `shared_types.py`, `config_loader.py`, `sitecustomize.py` 等 |

### 文档路径变更

| 旧路径 | 新路径 |
|--------|--------|
| `docs/DEVELOPER_GUIDE.md` | `docs/onboarding/developer-guide.md` |
| `docs/DEBUGGING.md` | `docs/development/debugging.md` |
| `docs/SCHEMAS.md` | `docs/api/schemas.md` |
| `docs/DOMAIN_EVENTS.md` | `docs/architecture/domain-events.md` |
| `docs/TECHNICAL_CONSTRAINTS.md` | `docs/architecture/technical-constraints.md` |

---

## Stats

| 指标 | 数值 |
|------|------|
| 总变更文件 | 685 |
| 删除文件 | 320 |
| 新增文件 | 87 |
| 修改文件 | 260 |

### 测试结果

| 类别 | 状态 |
|------|------|
| pytest | **2463 passed**, 194 skipped |
| 前端构建 | **SUCCESS** (52.81s, 无警告) |
| import-linter | **4 contracts kept, 0 broken** |

---

## Bug Fixes

1. **test_developer_documentation_exists** - 更新文档路径引用以匹配新的目录结构
2. **test_owasp_top_10_protection** - 为 `/health` 端点的所有响应路径添加 `X-Content-Type-Options` 和 `X-Frame-Options` 安全头

---

## Verification Checklist

- [x] `pytest tests/` - 2463 passed, 0 failed
- [x] `npm run build` - SUCCESS, 无警告
- [x] `lint-imports` - 4 contracts kept
- [x] OWASP 安全头配置完整
- [x] 文档路径测试通过

---

## Architecture Contracts Preserved

```
Functional Core Isolation     KEPT
Character Context Isolation   KEPT
Narrative Context Isolation   KEPT
Campaign Context Isolation    KEPT
```

---

## Files Changed Summary

主要变更区域：
- `src/api/main_api_server.py` - 添加安全头
- `tests/test_foundation.py` - 更新文档路径测试
- `docs/` - 目录结构重组
- `src/contexts/` - DDD 领域模块集中化

---

*Generated by Claude Code - Golden Master Release Preparation*
